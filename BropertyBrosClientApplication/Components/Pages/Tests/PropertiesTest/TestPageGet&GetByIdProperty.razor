@page "/TestGetProperty"
@using BropertyBrosClientApplication.DTO.Properties
@using BropertyBrosClientApplication.Services
@inject PropertyService PropertyService
@rendermode InteractiveServer

@*Author: Daniel*@
<h1>Get Properties</h1>
@if (properties == null)
{
	<p>Loading...</p>
}
else
{
	<ul>
		@foreach (var property in properties)
		{
			<li>@property.Address</li>
		}
	</ul>
}

<h1>Get Property by Id</h1>

<input type="number" @bind="propertyId" placeholder="Enter Property ID" />
<button class="btn btn-primary" @onclick="GetProperty">Get Property</button>

@if (isLoading)
{
	<p>Loading...</p>
}
else if (property != null)
{
	<div class="mt-3">
		<h2>Property Details</h2>
		<p><strong>ID:</strong> @property.Id</p>
		<p><strong>Name:</strong> @property.Address</p>
	</div>
}
else if (hasTried && property == null)
{
	<p>No category found with ID: @propertyId</p>
}

@code {
	private List<PropertyReadDto>? properties;
	private int propertyId;
	private PropertyReadDto? property;
	private bool isLoading = false;
	private bool hasTried = false;

	protected override async Task OnInitializedAsync()
	{
		properties = await PropertyService.GetAllPropertiesAsync();
	}

	private async Task GetProperty()
	{
		isLoading = true;
		hasTried = true;
		property = null;

		try
		{
			property = await PropertyService.GetPropertyByIdAsync(propertyId);
		}
		catch (Exception ex)
		{
			Console.WriteLine($"Error fetching property: {ex.Message}");
		}
		finally
		{
			isLoading = false;
		}
	}
}
